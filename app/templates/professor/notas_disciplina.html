<!doctype html>
{% extends "base.html" %}

{% block title %}Notas{% endblock %}

{% block header %}
  <h1>Notas - {{ contexto['disciplina_nome'] }}</h1>
{% endblock %}

{% block content %}
  <h2>Turma</h2>
  <p>
    <strong>Curso:</strong> {{ contexto['curso_nome'] }} |
    <strong>Classe:</strong> {{ contexto['ano'] }} |
    <strong>Turma:</strong> {{ contexto['designacao'] }} |
    <strong>Ano lectivo:</strong> {{ contexto['ano_lectivo'] }}
  </p>

  <p><strong>Notas preenchidas:</strong> {{ total_preenchido }} / {{ total_esperado }}</p>

  <form method="get" action="{{ url_for('professor.notas_disciplina', turma_disciplina_id=contexto['turma_disciplina_id']) }}">
    <label for="trimestre"><strong>Trimestre</strong></label>
    <select id="trimestre" name="trimestre" onchange="this.form.submit()">
      <option value="1" {% if trimestre == 1 %}selected{% endif %}>1º</option>
      <option value="2" {% if trimestre == 2 %}selected{% endif %}>2º</option>
      <option value="3" {% if trimestre == 3 %}selected{% endif %}>3º</option>
    </select>
  </form>

  <h2>Lançar/Editar Notas</h2>

  <form method="post" action="{{ url_for('professor.salvar_notas_disciplina', turma_disciplina_id=contexto['turma_disciplina_id']) }}">
    <input type="hidden" name="trimestre" value="{{ trimestre }}">

    <table border="1">
      <thead>
        <tr>
          <th>Aluno</th>
          <th>Nota (0-20)</th>
        </tr>
      </thead>
      <tbody>
        {% for m in matriculas %}
          <tr>
            <td>{{ m['nome'] }}</td>
            <td>
              <input
                type="number"
                name="nota-{{ m['matricula_id'] }}"
                min="0"
                max="20"
                step="0.1"
                value="{{ notas.get(m['matricula_id'], '') }}"
              >
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <button type="submit">Salvar notas do {{ trimestre }}º trimestre</button>
  </form>

  <a href="{{ url_for('professor.index') }}">Voltar para Área do Professor</a>
{% endblock %}
